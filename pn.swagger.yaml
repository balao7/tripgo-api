swagger: '2.0'
info:
  version: 1.0.0
  title: Push Notifications
  description: Endpoint for push notifications, there are two groups of endpoints

      - adding/removing devices to a specific user

      - testing push notification per device or userid.
basePath: /api
tags:
  - name: User
    description: update user profile data
  - name: Push
    description: send push notifications


paths:
  /user/push:
    post:
      tags:
        - User
      summary: add push notification token to user
      description: Add/update a device/platform specific token for push notifications
      consumes:
        - application/json
      parameters:
        - name: userToken
          in: header
          type: string
        - name: body
          in: body
          schema:
            $ref: '#/definitions/json_push_token'
          description: push notification data
      responses:
        '200':
          schema:
            type: object
          headers: {}
          description: Success
        '204':
          schema:
            type: object
          headers: {}
          description: No change saved
        default:
          description: Unexpected error.
    delete:
      tags:
        - User
      summary: remove a device token for push notifications
      description: Remove a device/platform specific token for push notifications
      parameters:
        - name: userToken
          in: header
          type: string
        - name: body
          in: body
          schema:
            $ref: '#/definitions/json_push_device'
          description: push notification device data
      responses:
        '200':
          schema:
            type: object
          headers: {}
          description: Success
        '204':
          schema:
            type: object
          headers: {}
          description: No change saved
        default:
          description: Unexpected error.

  /push/android/{token}:
    post:
      tags:
        - Push
      summary: send push notification to Android
      description: send a push notification to the Android device of the specified token
      consumes:
        - application/json
      parameters:
        - name: userToken
          in: header
          type: string
        - name: token
          in: path
          required: true
          type: string
          description: token of the android device
        - name: body
          in: body
          schema:
            $ref: '#/definitions/json_unified_message'
          description: push notification message
      responses:
        '200':
          schema:
            type: object
          headers: {}
          description: Success
        '204':
          schema:
            type: object
          headers: {}
          description: No change saved
        default:
          description: Unexpected error.
  /push/ios/{token}:
    post:
      tags:
        - Push
      summary: send push notification to iOS
      description: send a push notification to the iOS device of the specified token
      consumes:
        - application/json
      parameters:
        - name: userToken
          in: header
          type: string
        - name: token
          in: path
          required: true
          type: string
          description: token of the iOS device
        - name: body
          in: body
          schema:
            $ref: '#/definitions/json_unified_message'
          description: push notification message
      responses:
        '200':
          schema:
            type: object
          headers: {}
          description: Success
        '204':
          schema:
            type: object
          headers: {}
          description: No change saved
        default:
          description: Unexpected error.
  /push/{userid}:
    post:
      tags:
        - Push
      summary: send push notification to the registered devices of the user
      description: send a push notification to the given user registered devices
      consumes:
        - application/json
      parameters:
        - name: userToken
          in: header
          type: string
        - name: userid
          in: path
          required: true
          type: string
          description: token of the android device
        - name: body
          in: body
          schema:
            $ref: '#/definitions/json_unified_message'
          description: push notification message
      responses:
        '200':
          schema:
            type: object
          headers: {}
          description: Success
        '204':
          schema:
            type: object
          headers: {}
          description: No change saved
        default:
          description: Unexpected error.
definitions:
  json_push_device:
    type: object
    title: PushNotificationDevice
    properties:
      platform:
        type: string
        enum:
          - android
          - ios
        description: android or ios device
      deviceid:
        type: string
        description: a unique id for that user/device pair
  json_push_token:
    type: object
    title: PushNotificationToken
    allOf:
      - $ref: '#/definitions/json_push_device'
      - properties:
          token:
            type: string
  json_unified_message:
    type: object
    title: PushNotificationMessage
    properties:
      message:
        type: string
        description: notification message
      sound:
        type: string
        description: sound
      badge:
        type: integer
        description: badge
      ttl:
        type: integer
        description: time to live for the notification
